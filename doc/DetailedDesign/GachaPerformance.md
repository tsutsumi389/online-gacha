# ガチャ演出画面 詳細設計

## 1. 画面概要
- ガチャを引いた際に表示されるアニメーション・演出画面
- 1回用・10連用の2パターン
- 一般演出／確定演出／逆転演出の3種を用意
- **演出終了後に当選商品を表示する**

## 2. 主な演出パターン
- **一般演出**: 通常のアニメーション（カプセルが回転・開封、光エフェクト等）
- **確定演出**: 高レアリティ確定時の特別な演出（虹色エフェクト、豪華なBGM、特別なカットイン等）
- **逆転演出**: 一度ハズレ演出を見せた後、途中で高レアリティに昇格する演出（カプセル色変化、雷・爆発エフェクト等）

## 3. 画面レイアウト（ワイヤーフレーム例）

### 1回用
```
+-----------------------------+
|         [演出アニメ]        |
|   カプセル・光・エフェクト   |
|-----------------------------|
|         [結果表示]          |
|   当選商品画像・名称        |
|   ※演出終了後に表示        |
|-----------------------------|
| [もう一度引く] [戻る]       |
+-----------------------------+
```

### 10連用
```
+-----------------------------+
|         [演出アニメ]        |
| 10個のカプセルが並ぶ        |
|-----------------------------|
|      [結果リスト表示]       |
|  各当選商品画像・名称       |
|   ※演出終了後に表示        |
|-----------------------------|
| [もう一度10連] [戻る]       |
+-----------------------------+
```

## 4. 各要素の詳細
- **演出アニメ**: React + Three.js/PixiJS/Framer Motionで実装。演出種別に応じてアニメーション切替。
- **結果表示**: 当選商品画像・名称を大きく表示（10連はリスト形式）。**演出終了後にのみ表示**。
- **ボタン**: もう一度引く／戻る

## 5. 演出分岐ロジック
- 抽選結果に応じて演出種別を決定
  - 高レアリティ当選時 → 確定演出
  - 通常当選時 → 一般演出
  - 逆転パターン（抽選後に昇格） → 逆転演出
- 10連の場合は各カプセルごとに演出を分岐、または全体で一括演出

## 6. API設計（例）
- POST /api/gachas/:id/draw ... ガチャ実行（1回/10回）
  - レスポンスで演出種別・当選商品リストを返却

## 7. バリデーション・UX
- スキップボタンで演出を省略可能
- 結果表示時はアニメーション終了後にボタン有効化
- 10連は演出短縮モードも用意
- **当選商品は演出終了後にのみ表示し、演出中は非表示とする**

## 8. 備考
- スマホ・PC両対応
- アニメーションはパフォーマンス考慮し最適化
- BGM・SEも演出種別ごとに切替

---
