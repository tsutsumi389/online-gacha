
# マイガチャ管理・編集画面 詳細設計

## 1. 画面概要
- 自分が出品・管理しているガチャの新規作成・編集・削除・アイテム管理・画像管理を行う画面
- すべてのユーザーが自分のガチャのみ管理可能
- **URL構造**: 
  - マイガチャ管理: `/my-gacha`
  - ガチャ新規作成: `/my-gacha/new`
  - ガチャ編集: `/my-gacha/edit/:id`
  - ガチャ状況確認: `/my-gacha/:id/status`

## 2. 画面構成

### 2.1 マイガチャ管理画面（AdminGachaManage）
- **URL**: `/my-gacha`
- ガチャ一覧表示（ページネーション対応、10件/ページ）
  - ガチャ名、価格、公開状態（スイッチ）、表示期間、総在庫数、プレイ回数
- 新規作成ボタン（`/my-gacha/new`へ遷移）
- 画像管理ボタン（ダイアログ表示）
- 編集・削除・状況確認ボタン（各行に表示）
- 検索・フィルタ機能（将来対応）

### 2.2 ガチャ編集/新規作成画面（AdminGachaEdit）
- **新規作成URL**: `/my-gacha/new`
- **編集URL**: `/my-gacha/edit/:id`
- 基本情報入力（ガチャ名、説明、価格、公開/非公開、表示期間）
- ガチャ画像管理（複数画像、並び替え、メイン画像指定、アップロード/削除、プレビュー）
- アイテム管理（ガチャ作成後に表示、アイテム追加・編集・削除）
- 保存/キャンセルボタン
- 一覧に戻るボタン（`/my-gacha`）

### 2.3 アイテム編集ダイアログ
- アイテム名、説明、在庫数、画像アップロード（JPEG/PNG/WebP/AVIF自動変換）、公開/非公開切替

### 2.4 画像管理ダイアログ
- アップロード済み画像一覧、削除・並び替え・メイン画像指定、未使用画像の一括削除（将来対応）

### 2.5 削除確認ダイアログ
- ガチャ・アイテム・画像削除時の確認メッセージ

## 3. バリデーション・UX
- 必須項目未入力時は保存不可
- ガチャ名: 1-128文字、必須
- 説明: 0-1000文字
- 価格: 1以上の整数、必須
- アイテム名: 1-128文字、必須
- 在庫数: 0以上の整数
- 画像ファイル: JPEG/PNG/WebP/AVIF、最大10MB
- 画像アップロード時の進捗表示
- エラー時は日本語メッセージ表示

## 4. API設計
- **GET   `/api/my/gachas`** ... 自分のガチャ一覧取得（ページネーション・ソート対応）
- **POST  `/api/my/gachas`** ... 新規作成
- **PUT   `/api/my/gachas/:id`** ... 編集
- **DELETE `/api/my/gachas/:id`** ... 削除
- **PUT   `/api/my/gachas/:id/toggle-public`** ... 公開/非公開切替
- **GET   `/api/my/gachas/:id`** ... 詳細取得
- **GET   `/api/my/gachas/:id/items`** ... アイテム一覧取得
- **POST  `/api/my/gachas/:id/items`** ... アイテム追加
- **PUT   `/api/my/gachas/:gachaId/items/:itemId`** ... アイテム編集
- **DELETE `/api/my/gachas/:gachaId/items/:itemId`** ... アイテム削除
- **画像管理API**: `/api/my/gachas/:id/images`系（アップロード・並び替え・削除・メイン画像指定）

## 5. レスポンス例
- ガチャ一覧・詳細・アイテム・画像レスポンスは`/api/my/gachas`系の実装に準拠（`AdminGachaList.md`参照）

## 6. 権限制御・セキュリティ
- 全ユーザーが自身のガチャのみ管理可能（管理者ロール不要）
- APIはJWT認証必須
- オーナーシップ検証、入力値バリデーション、画像ファイル検証

## 7. 備考
- レスポンシブ対応（スマホ・PC）
- Material-UI + Framer MotionによるUI
- 画像はMinIOに保存、Sharp.jsで自動リサイズ・AVIF/WebP/JPEG生成
- 検索・フィルタ・未使用画像一括削除は将来拡張予定
